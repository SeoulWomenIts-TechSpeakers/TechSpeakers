# [Redis/Kafka 이용한 대용량 트래픽 예약 및 쿠폰 발급 서비스] 1. 동시성과 순서를 고려하지 않은 기존 구조

### ⚒️ 현재 동기식 서버 아키텍처

#### 1. 시퀀스 다이어그램

- 회원에 한해서 예약이 가능함
- 들어온 예약은 호스트 테이블에 있는 재고와 비교하여
  - 재고가 예약 요청보다 더 많은 경우 예약 체결
  - 그렇지 않은 경우 return
- 예약이 완료된 후, 지정한 쿠폰이 없는 회원에 한해서 쿠폰 발급

#### 2. 클래스 다이어그램

#### 3. 데이터 ERD

<br>

### 💥발생하는 문제

    - 동시에 요청이 들어오는 경우 재고 데이터 정합성 불일치
    - 대량 트래픽이 발생하는 경우, 계속해서 재고 확인하여 과도한 디스크 I/O 발생할 수 있음
    - 예약 클래스에 쿠폰 발급 로직이 혼재되어 있어서, 역할에 따른 구분이 지켜지지 않았음 (쿠폰과 예약은 별도 로직임)
    - 쿠폰의 재고가 있는 경우, 요청한 스레드의 순서가 보장되지 않음

- 동시성 문제란
- 절차적 프로그래밍

#### 1. 테스트 코드 예시

#### 2. Executors와 스레드 작동방식

<br>

### 💬 어떻게 해결할 것인가

#### 동시성 문제 해결

#### 디스크 I/O문제 해결 방법

#### 객체지향 프로그래밍 지향

https://medium.com/@rlawlgh3245/redis-kafka-%EC%9D%B4%EC%9A%A9%ED%95%9C-%EB%8C%80%EC%9A%A9%EB%9F%89-%ED%8A%B8%EB%9E%98%ED%94%BD-%EC%98%88%EC%95%BD-%EB%B0%8F-%EC%BF%A0%ED%8F%B0-%EB%B0%9C%EA%B8%89-%EC%84%9C%EB%B9%84%EC%8A%A4-1-%EB%8F%99%EC%8B%9C%EC%84%B1%EA%B3%BC-%EC%88%9C%EC%84%9C%EB%A5%BC-%EA%B3%A0%EB%A0%A4%ED%95%98%EC%A7%80-%EB%AA%BB%ED%95%9C-%EA%B8%B0%EC%A1%B4-%EA%B5%AC%EC%A1%B0-a8eac77fd33f
